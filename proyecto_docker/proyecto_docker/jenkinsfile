pipeline {
    agent any

    stages {
        stage('Create Dockerfile') {
            steps {
                bat '''
                echo # Dockerfile generado automÃ¡ticamente > Dockerfile
                echo FROM nginx:alpine >> Dockerfile
                echo COPY . /usr/share/nginx/html >> Dockerfile
                echo EXPOSE 80 >> Dockerfile
                '''
            }
        }

        stage('docker build') {
            steps {
                bat "docker build -t caosbinario/homer_page:1.0.0-${BUILD_ID} ."
            }
        }

        stage('docker push') {
            steps {
                bat "docker push caosbinario/homer_page:1.0.0-${BUILD_ID}"
            }
        }
    }
}